# 预览区域虚拟滚动优化计划

## 目标
实现预览区域的虚拟滚动机制，进一步提升超大文档的渲染性能。

## 待实现功能

### 1. 基础虚拟滚动架构
- [ ] 将 AST 节点作为虚拟滚动的基本单位
- [ ] 实现可视区域内容的动态渲染
- [ ] 建立虚拟项的索引和映射系统

### 2. 高度管理系统
- [ ] 为不同类型的 Markdown 元素设置预估高度
- [ ] 实现动态高度测量和缓存机制
- [ ] 处理图片加载等异步高度变化
- [ ] 建立高度修正和更新机制

### 3. 滚动同步优化
- [ ] 建立编辑器行号与预览虚拟项的精确映射
- [ ] 实现虚拟滚动环境下的位置转换算法
- [ ] 保持编辑器和预览区域的滚动同步精度

### 4. 性能优化
- [ ] 实现渲染项的复用机制
- [ ] 优化虚拟滚动的计算性能
- [ ] 减少不必要的 DOM 操作和重绘

### 5. 兼容性处理
- [ ] 保留当前 v-html 方案作为降级选项
- [ ] 实现虚拟滚动的开关配置
- [ ] 确保现有功能（复制按钮、主题切换等）正常工作

## 技术方案备选
1. 基于段落的虚拟滚动（自实现）
2. 使用第三方虚拟滚动库（@tanstack/vue-virtual）
3. 混合方案（小文档使用普通渲染，大文档切换虚拟滚动）

## 性能指标
- 目标：支持 10万+ 行文档流畅预览
- DOM 节点数量控制在 100 个以内
- 滚动响应时间 < 16ms（60fps）
